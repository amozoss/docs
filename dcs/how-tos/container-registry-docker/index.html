<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Use Storj as a container registry"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Container Registry - Docker"><meta property="og:description" content="Use Storj as a container registry"><meta property="og:type" content="article"><meta property="og:url" content="/dcs/how-tos/container-registry-docker/"><meta property="article:section" content="dcs"><title>Container Registry - Docker | Storj Docs</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.f89e84d24aa67a9627cfb7a3b446b3b062a451eebceb8d5f060601553c0a6cfb.css><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.afc156b59ccdf08ee689010e2667621d6ac7b00f30a969882371f26dd69b9b61.js></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js></script>
<link rel=subresource href=/fonts/Inter-roman.var.woff2><link rel=subresource href=/fonts/Inter-italic.var.woff2></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Storj Docs</span></a></h2><div class=book-search><input type=text id=book-search-input data-filter=/dcs/ placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-first-sections><li class=active><a href=/dcs/>DCS</a></li><li><a href=/node/>Node Operator</a></li></ul><ul><li class=book-section-flat><span>Decentralized Cloud Storage</span><ul><li><a href=/dcs/storage/considerations/>Product Overview</a></li></ul></li><li class=book-section-flat><span>Downloads</span><ul><li><a href=/dcs/downloads/download-uplink-cli/>Download Uplink CLI</a></li><li><a href=/dcs/downloads/download-self-hosted-s3-compatible-gateway/>Download Self-hosted S3 Compatible Gateway</a></li><li><a href=/dcs/downloads/download-storj-client-libraries/>Download Storj Client Libraries</a></li></ul></li><li class=book-section-flat><span>Getting Started</span><ul><li><a href=/dcs/getting-started/quickstart-guide/>Quickstart Guide</a></li><li><a href=/dcs/getting-started/quickstart-objectbrowser/>Quickstart - Object Browser</a></li><li><input type=checkbox id=section-8a2bc98c91c60155c8bcc6967e5b3cf7 class=toggle>
<label for=section-8a2bc98c91c60155c8bcc6967e5b3cf7 class="flex justify-between"><a href=/dcs/getting-started/gateway-mt/>Quickstart - AWS CLI and Hosted Gateway MT</a></label><ul><li><a href=/dcs/getting-started/gateway-mt/aws-cli-advanced-options/>AWS CLI Advanced Options</a></li></ul></li><li><a href=/dcs/getting-started/quickstart-aws-sdk-and-hosted-gateway-mt/>Quickstart - AWS SDK and Hosted Gateway MT</a></li><li><input type=checkbox id=section-eb51eff27101399663fec0a5feb790b7 class=toggle>
<label for=section-eb51eff27101399663fec0a5feb790b7 class="flex justify-between"><a href=/dcs/getting-started/quickstart-uplink-cli/>Quickstart - Uplink CLI</a></label><ul><li><a href=/dcs/getting-started/quickstart-uplink-cli/prerequisites/>Prerequisites</a></li><li><input type=checkbox id=section-1cc3e1bb03e2e308966123bb1cc84dfc class=toggle>
<label for=section-1cc3e1bb03e2e308966123bb1cc84dfc class="flex justify-between"><a href=/dcs/getting-started/quickstart-uplink-cli/uploading-your-first-object/>Uploading Your First Object CLI</a></label><ul><li><a href=/dcs/getting-started/quickstart-uplink-cli/uploading-your-first-object/create-first-access-grant/>Create an Access Grant</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/uploading-your-first-object/set-up-uplink-cli/>Set Up Uplink CLI with Access Grant</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/uploading-your-first-object/create-a-bucket/>Create a Bucket</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/uploading-your-first-object/upload-an-object/>Upload an Object</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/uploading-your-first-object/view-distribution-of-an-object/>View Distribution of an Object</a></li></ul></li><li><input type=checkbox id=section-ef98e9c48f14a1e6e3291b7ffdd021df class=toggle>
<label for=section-ef98e9c48f14a1e6e3291b7ffdd021df class="flex justify-between"><a href=/dcs/getting-started/quickstart-uplink-cli/interacting-with-your-first-object/>Interacting With Your First Object CLI</a></label><ul><li><a href=/dcs/getting-started/quickstart-uplink-cli/interacting-with-your-first-object/list-an-object/>List an Object</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/interacting-with-your-first-object/download-an-object/>Download an Object</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/interacting-with-your-first-object/delete-an-object/>Delete an Object</a></li></ul></li><li><input type=checkbox id=section-583035221fd089be3bccd9566e3d01dd class=toggle>
<label for=section-583035221fd089be3bccd9566e3d01dd class="flex justify-between"><a href=/dcs/getting-started/quickstart-uplink-cli/sharing-your-first-object/>Sharing Your First Object</a></label><ul><li><a href=/dcs/getting-started/quickstart-uplink-cli/sharing-your-first-object/prerequisites/>Prerequisites</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/sharing-your-first-object/generate-access/>Create an Access to an Object</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/sharing-your-first-object/import-access/>Import an Access to an Object</a></li><li><a href=/dcs/getting-started/quickstart-uplink-cli/sharing-your-first-object/revoke-an-access-to-an-object/>Revoke an Access to an Object</a></li></ul></li><li><input type=checkbox id=section-5272dcaf3a9682609c7d3fdd368cf961 class=toggle>
<label for=section-5272dcaf3a9682609c7d3fdd368cf961 class="flex justify-between"><a href=/dcs/getting-started/quickstart-uplink-cli/generate-access-grants-and-tokens/>Advanced Usage</a></label><ul><li><a href=/dcs/getting-started/quickstart-uplink-cli/generate-access-grants-and-tokens/generate-a-token/>Create Access Grant in CLI</a></li></ul></li></ul></li><li><input type=checkbox id=section-e035376383ed4301f1acc99452a9495f class=toggle>
<label for=section-e035376383ed4301f1acc99452a9495f class="flex justify-between"><a href=/dcs/getting-started/satellite-developer-account/>Quickstart - Satellite Admin Console</a></label><ul><li><a href=/dcs/getting-started/satellite-developer-account/creating-your-account/>Creating Your Account</a></li><li><a href=/dcs/getting-started/satellite-developer-account/manage-projects/>Manage Projects</a></li><li><a href=/dcs/getting-started/satellite-developer-account/dashboard/>Dashboard</a></li><li><a href=/dcs/getting-started/satellite-developer-account/objects/>Buckets</a></li><li><a href=/dcs/getting-started/satellite-developer-account/access-grants/>Access</a></li><li><a href=/dcs/getting-started/satellite-developer-account/users/>Users</a></li><li><a href=/dcs/getting-started/satellite-developer-account/billing/>Billing</a></li><li><a href=/dcs/getting-started/satellite-developer-account/resources/>Resources</a></li><li><a href=/dcs/getting-started/satellite-developer-account/quick-start/>Quick Start</a></li><li><a href=/dcs/getting-started/satellite-developer-account/my-account/>My Account</a></li></ul></li></ul></li><li class=book-section-flat><span>SDK & Reference</span><ul><li><input type=checkbox id=section-e71eaa406f51abd64ce74a83dbe5dd13 class=toggle>
<label for=section-e71eaa406f51abd64ce74a83dbe5dd13 class="flex justify-between"><a href=/dcs/api-reference/s3-compatible-gateway/>Storj-hosted S3 Compatible Gateway</a></label><ul><li><input type=checkbox id=section-5fc59ab320b4677ae3ebd53fe7b10db5 class=toggle>
<label for=section-5fc59ab320b4677ae3ebd53fe7b10db5 class="flex justify-between"><a href=/dcs/api-reference/s3-compatible-gateway/multipart-upload/>Multipart Upload</a></label><ul><li><a href=/dcs/api-reference/s3-compatible-gateway/multipart-upload/multipart-part-size/>Multipart Part Size</a></li></ul></li><li><a href=/dcs/api-reference/s3-compatible-gateway/using-presigned-urls/>Using presigned URLs</a></li><li><a href=/dcs/api-reference/s3-compatible-gateway/supported-s3-commands/>Supported S3 Commands</a></li></ul></li><li><input type=checkbox id=section-e534a50d47604ebc17cdb3d09a7bbe5c class=toggle>
<label for=section-e534a50d47604ebc17cdb3d09a7bbe5c class="flex justify-between"><a href=/dcs/api-reference/uplink-cli/>Uplink CLI</a></label><ul><li><input type=checkbox id=section-ab2e55a365604a01b5cad7151a01b544 class=toggle>
<label for=section-ab2e55a365604a01b5cad7151a01b544 class="flex justify-between"><a href=/dcs/api-reference/uplink-cli/access-command/>access</a></label><ul><li><a href=/dcs/api-reference/uplink-cli/access-command/access-inspect-command/>access inspect</a></li><li><a href=/dcs/api-reference/uplink-cli/access-command/access-list-command/>access list</a></li><li><a href=/dcs/api-reference/uplink-cli/access-command/access-register/>access register</a></li></ul></li><li><a href=/dcs/api-reference/uplink-cli/cp-command/>cp</a></li><li><a href=/dcs/api-reference/uplink-cli/import-command/>import</a></li><li><a href=/dcs/api-reference/uplink-cli/ls-command/>ls</a></li><li><a href=/dcs/api-reference/uplink-cli/uplink-mb-command/>mb</a></li><li><input type=checkbox id=section-12823ba9c45a10b81b0eaecb4dfc8ebb class=toggle>
<label for=section-12823ba9c45a10b81b0eaecb4dfc8ebb class="flex justify-between"><a href=/dcs/api-reference/uplink-cli/meta-command/>meta</a></label><ul><li><a href=/dcs/api-reference/uplink-cli/meta-command/meta-get-command/>meta get</a></li></ul></li><li><a href=/dcs/api-reference/uplink-cli/mv/>mv</a></li><li><a href=/dcs/api-reference/uplink-cli/rb-command/>rb</a></li><li><a href=/dcs/api-reference/uplink-cli/rm-command/>rm</a></li><li><a href=/dcs/api-reference/uplink-cli/setup-command/>setup</a></li><li><a href=/dcs/api-reference/uplink-cli/share-command/>share</a></li></ul></li><li><input type=checkbox id=section-03ffd000c84f3189e27b539e51443e62 class=toggle>
<label for=section-03ffd000c84f3189e27b539e51443e62 class="flex justify-between"><a href=/dcs/api-reference/s3-gateway/>Self-hosted S3 Compatible Gateway</a></label><ul><li><a href=/dcs/api-reference/s3-gateway/gateway-st-advanced-usage/>Gateway ST Advanced Usage</a></li></ul></li><li><a href=/dcs/api-reference/linksharing-service/>Linksharing Service</a></li><li><input type=checkbox id=section-0848317479e2fc58b812eefd4912b4a4 class=toggle>
<label for=section-0848317479e2fc58b812eefd4912b4a4 class="flex justify-between"><a href=/dcs/api-reference/storj-client-libraries/>Storj Client Libraries</a></label><ul><li><a href=https://github.com/storj/uplink class=book-external-link target=_blank rel=noopener>Go<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=https://github.com/storj/uplink-c class=book-external-link target=_blank rel=noopener>C<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=https://github.com/storj/uplink-android class=book-external-link target=_blank rel=noopener>Android<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=https://github.com/storj/uplink-java class=book-external-link target=_blank rel=noopener>Java<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=https://www.npmjs.com/package/uplink-nodejs class=book-external-link target=_blank rel=noopener>NodeJS<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li></ul></li></ul></li><li class=book-section-flat><span>How To's</span><ul><li><a href=/dcs/how-tos/container-registry-docker/ class=active>Container Registry - Docker</a></li><li><input type=checkbox id=section-591e24e11327becce048ce6a5d0b3e18 class=toggle>
<label for=section-591e24e11327becce048ce6a5d0b3e18 class="flex justify-between"><a href=/dcs/how-tos/host-a-static-website/>Host a Static Website</a></label><ul><li><a href=/dcs/how-tos/host-a-static-website/host-a-static-website-with-the-cli-and-linksharing-service/>Host a Static Website with the Uplink CLI and Linksharing Service</a></li></ul></li><li><a href=/dcs/how-tos/configure-tools-for-the-partner-program/>Configure Tools for the Partner Program</a></li><li><a href=/dcs/how-tos/fastly-integration/>Fastly Integration</a></li><li><a href=https://filebase.com class=book-external-link target=_blank rel=noopener>Configure Filebase for easy upload<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=/dcs/how-tos/backup-with-duplicati/>Backup With Duplicati</a></li><li><a href=/dcs/how-tos/nft-storage/>NFT storage for OpenSea</a></li><li><input type=checkbox id=section-8fe4791a1117b6b147a551b2324e5838 class=toggle>
<label for=section-8fe4791a1117b6b147a551b2324e5838 class="flex justify-between"><a href=/dcs/how-tos/sync-files-with-rclone/>Sync Files With Rclone</a></label><ul><li><a href=/dcs/how-tos/sync-files-with-rclone/rclone-with-native-integration/>Rclone with Native Integration</a></li><li><a href=/dcs/how-tos/sync-files-with-rclone/rclone-with-hosted-gateway/>Rclone with Hosted Gateway</a></li></ul></li><li><a href=/dcs/how-tos/backup-with-restic/>Backup With Restic</a></li><li><a href=/dcs/how-tos/set-up-filezilla-for-decentralized-file-transfer/>FileZilla Native Integration</a></li><li><a href=/dcs/how-tos/filezilla-pro-integration-guide/>Filezilla Pro Integration Guide</a></li><li><a href=/dcs/how-tos/mongodb-ops-manager-backup/>MongoDB Ops Manager Backup</a></li><li><a href=/dcs/how-tos/tesla-sentry-mode-teslausb/>Store Tesla Sentry Mode & Dashcam videos on Storj DCS</a></li><li><a href=/dcs/how-tos/how-to-connect-s3fs-to-storj-dcs/>How to connect s3fs to Storj DCS</a></li><li><a href=/dcs/how-tos/how-to-set-up-video-analytics-and-video-management-with-kerberos-vault/>How to set up video analytics and video management with Kerberos Vault</a></li><li><a href=/dcs/how-tos/how-to-hod-rod-file-transfer-performance-on-storj-dcs/>How to Hod Rod File Transfer Performance on Storj DCS</a></li><li><a href=/dcs/how-tos/backups-with-hashbackup/>Backups with HashBackup</a></li><li><a href=/dcs/how-tos/how-to-use-plex-and-storj-dcs-as-a-private-streaming-service/>How to use Plex and Storj DCS as a private streaming service</a></li><li><a href=/dcs/how-tos/how-to-use-cyberduck-and-storj-dcs/>How to use Cyberduck and Storj DCS</a></li><li><a href=/dcs/how-tos/storj-ipfs-pinning-service-beta/>Storj IPFS Pinning Service (Beta)</a></li><li><a href=/dcs/how-tos/simplify-file-management-with-s3-browser-and-storj-dcs/>Simplify File Management with S3 Browser and Storj DCS</a></li><li><a href=/dcs/how-tos/kubernetes-backup-via-velero/>Kubernetes Backup via Velero</a></li></ul></li><li class=book-section-flat><span>Solution Architectures</span><ul><li><a href=/dcs/solution-architectures/common-use-cases/>Common Use Cases</a></li><li><a href=/dcs/solution-architectures/common-architectural-patterns/>Common Architectural Patterns</a></li></ul></li><li class=book-section-flat><span>Concepts</span><ul><li><a href=/dcs/concepts/overview/>Understanding Storj DCS</a></li><li><a href=/dcs/concepts/definitions/>Definitions</a></li><li><a href=/dcs/concepts/key-architecture-constructs/>Key Architecture Constructs</a></li><li><input type=checkbox id=section-e3983b48cc8585311f4fd92a3441c885 class=toggle>
<label for=section-e3983b48cc8585311f4fd92a3441c885 class="flex justify-between"><a href=/dcs/concepts/access/>Access Management</a></label><ul><li><input type=checkbox id=section-2aaccce9e50f91dfc9ae1f4f2919e73d class=toggle>
<label for=section-2aaccce9e50f91dfc9ae1f4f2919e73d class="flex justify-between"><a href=/dcs/concepts/access/access-grants/>Access Grants</a></label><ul><li><input type=checkbox id=section-6532f8fab18a0bf2730b54084407ef27 class=toggle>
<label for=section-6532f8fab18a0bf2730b54084407ef27 class="flex justify-between"><a href=/dcs/concepts/access/access-grants/api-key/>API Key</a></label><ul><li><a href=/dcs/concepts/access/access-grants/api-key/restriction/>Access Restrictions</a></li></ul></li><li><a href=/dcs/concepts/access/access-grants/when-to-use-the-satellite-web-interface-and-when-to-use-the-cli/>When to use the Satellite Web Interface and When to use the CLI</a></li></ul></li><li><input type=checkbox id=section-d17166aeaa257fe6cfe34e9469861364 class=toggle>
<label for=section-d17166aeaa257fe6cfe34e9469861364 class="flex justify-between"><a href=/dcs/concepts/access/encryption-and-keys/>Encryption Keys</a></label><ul><li><a href=/dcs/concepts/access/encryption-and-keys/key-management/>Key Management</a></li><li><a href=/dcs/concepts/access/encryption-and-keys/when-to-use-different-encryption-keys/>When to use different encryption keys</a></li></ul></li><li><a href=/dcs/concepts/access/access-revocation/>Access Revocation</a></li><li><a href=/dcs/concepts/access/capability-based-access-control/>Capability Based Access vs Access Control Lists</a></li><li><a href=/dcs/concepts/access/access-management-at-the-edge/>Access Management at the Edge</a></li></ul></li><li><input type=checkbox id=section-32bee2047eb722c84da55e9b4fbd0a7e class=toggle>
<label for=section-32bee2047eb722c84da55e9b4fbd0a7e class="flex justify-between"><a href=/dcs/concepts/edge-services/>Edge Services</a></label><ul><li><a href=/dcs/concepts/edge-services/auth-service/>Auth Service</a></li></ul></li><li><a href=/dcs/concepts/connectors/>Connectors</a></li><li><a href=/dcs/concepts/data-structure/>Data Structure</a></li><li><input type=checkbox id=section-273072f64771f53acb81a101acf9cdb9 class=toggle>
<label for=section-273072f64771f53acb81a101acf9cdb9 class="flex justify-between"><a href=/dcs/concepts/encryption-key/>Encryption</a></label><ul><li><a href=/dcs/concepts/encryption-key/how-encryption-is-implemented/>How Encryption is Implemented</a></li><li><a href=/dcs/concepts/encryption-key/design-decision-end-to-end-encryption/>Design Decision: End-to-end Encryption</a></li><li><a href=/dcs/concepts/encryption-key/design-decision-server-side-encryption/>Design Decision: Server-side Encryption</a></li></ul></li><li><input type=checkbox id=section-390f7f447019f4755db05aad8ca13661 class=toggle>
<label for=section-390f7f447019f4755db05aad8ca13661 class="flex justify-between"><a href=/dcs/concepts/decentralization/>Decentralization</a></label><ul><li><a href=/dcs/concepts/decentralization/coordination-avoidance/>Coordination Avoidance</a></li></ul></li><li><a href=/dcs/concepts/file-redundancy/>File Redundancy</a></li><li><a href=/dcs/concepts/multiregion-availability/>Multiregion Availability</a></li><li><a href=/dcs/concepts/limits/>Usage Limits</a></li><li><a href=/dcs/concepts/satellite/>Satellite (Metadata Region)</a></li><li><a href=/dcs/concepts/s3-compatibility/>S3 Compatibility</a></li><li><a href=/dcs/concepts/file-repair/>File Repair</a></li></ul></li><li class=book-section-flat><span>Support</span><ul><li><a href=/dcs/support/support-process-overview/>Support Overview</a></li><li><a href=/dcs/support/faqs/>FAQ</a></li><li><a href=https://forum.storj.io/c/engineer-amas/dev-category class=book-external-link target=_blank rel=noopener>Community Forum<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=https://status.tardigrade.io class=book-external-link target=_blank rel=noopener>Status Page<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li><li><a href=https://support.tardigrade.io class=book-external-link target=_blank rel=noopener>Help Desk<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li></ul></li><li class=book-section-flat><span>Billing, Payment & Accounts</span><ul><li><input type=checkbox id=section-e86e5160b6cbbb979535071ad9af4793 class=toggle>
<label for=section-e86e5160b6cbbb979535071ad9af4793 class="flex justify-between"><a href=/dcs/billing-payment-and-accounts-1/pricing/>Billing, Payment and Accounts</a></label><ul><li><a href=/dcs/billing-payment-and-accounts-1/pricing/billing-and-payment/>How Billing is Calculated</a></li><li><a href=/dcs/billing-payment-and-accounts-1/pricing/free-tier/>Free Plan</a></li><li><a href=/dcs/billing-payment-and-accounts-1/pricing/usage-limit-increases/>Usage Limit Increases</a></li></ul></li><li><input type=checkbox id=section-4e3c83ea13e2e7ae2025639618d7fec3 class=toggle>
<label for=section-4e3c83ea13e2e7ae2025639618d7fec3 class="flex justify-between"><a href=/dcs/billing-payment-and-accounts-1/storj-token/>Payment Methods</a></label><ul><li><a href=/dcs/billing-payment-and-accounts-1/storj-token/promotional-credits/>Promotional Credits</a></li><li><a href=/dcs/billing-payment-and-accounts-1/storj-token/debits-against-payment-methods/>Debits Against Payment Methods</a></li><li><a href=/dcs/billing-payment-and-accounts-1/storj-token/changing-payment-methods/>Changing Payment Methods</a></li><li><a href=/dcs/billing-payment-and-accounts-1/storj-token/deleting-a-payment-method/>Deleting a Payment Method</a></li><li><a href=/dcs/billing-payment-and-accounts-1/storj-token/expired-credit-card/>Expired Credit Card</a></li><li><a href=/dcs/billing-payment-and-accounts-1/storj-token/reporting-a-payment-problem/>Reporting a Payment Problem</a></li></ul></li><li><a href=/dcs/billing-payment-and-accounts-1/requesting-a-refund/>Requesting a Refund</a></li><li><a href=/dcs/billing-payment-and-accounts-1/closing-an-account/>Closing an Account</a></li><li><a href=/dcs/billing-payment-and-accounts-1/data-retention-policy/>Data Retention Policy</a></li></ul></li><li class=book-section-flat><span>Resources</span><ul><li><a href=https://www.storj.io/storjv3.pdf class=book-external-link target=_blank rel=noopener>Whitepaper<img src=/svg/external-link.svg class=book-icon alt="External Link"></a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Container Registry - Docker</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><div class=toc-title>Contents</div><nav id=TableOfContents><ul><li><ul><li><a href=#the-structure-of-a-container-registry-a-href_394oki6cys24-id_394oki6cys24a>The structure of a container registry <a href=#_394oki6cys24 id=_394oki6cys24></a></a></li><li><a href=#publish-the-container-a-href_8ar1a9qed06y-id_8ar1a9qed06ya>Publish the container <a href=#_8ar1a9qed06y id=_8ar1a9qed06y></a></a></li><li><a href=#summary-a-href_hzafm3yc7150-id_hzafm3yc7150a>Summary <a href=#_hzafm3yc7150 id=_hzafm3yc7150></a></a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=container-registry---docker>Container Registry - Docker
<a class=anchor href=#container-registry---docker>#</a></h1><p>Containers are wonderful: Containers provide a powerful way to package and deploy an application and make the runtime environment immutable and reproducible. But using containers also requires more infrastructure - distributing containers requires a docker registry, either a public one (like Dockerhub) or a private instance.</p><p>Under the hood, the container registry serves simple REST requests. As Storj DCS also can serve files via HTTP, it can be used as a container registry if the pieces are uploaded in the right order and mode.</p><h3 id=the-structure-of-a-container-registry-a-href_394oki6cys24-id_394oki6cys24a>The structure of a container registry <a href=#_394oki6cys24 id=_394oki6cys24></a>
<a class=anchor href=#the-structure-of-a-container-registry-a-href_394oki6cys24-id_394oki6cys24a>#</a></h3><p>But what is the right order? The container registry API follows a simple structure:</p><p><img src=/dcs/_assets/0-fix.png alt></p><p>Here we pull the <strong>elek/herbsttag</strong> image with the <strong>latest</strong> tag. The manifest can be found under <em>https://host/v2/elek/herbsttag/manifests/latest</em>.</p><p>The first item is a manifest JSON file that defines the required blobs and layer descriptors. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> <span style=color:#e6db74>&#34;schemaVersion&#34;</span>: 2,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> <span style=color:#e6db74>&#34;mediaType&#34;</span>: <span style=color:#e6db74>&#34;application/vnd.docker.distribution.manifest.v2+json&#34;</span>,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> <span style=color:#e6db74>&#34;config&#34;</span>: <span style=color:#f92672>{</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   <span style=color:#e6db74>&#34;mediaType&#34;</span>: <span style=color:#e6db74>&#34;application/vnd.docker.container.image.v1+json&#34;</span>,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   <span style=color:#e6db74>&#34;size&#34;</span>: 4416,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   <span style=color:#e6db74>&#34;digest&#34;</span>: <span style=color:#e6db74>&#34;sha256:833c7a986ed965eec8fe864223920c366fb0a25dd23edd0bdd2a4428fd0ce1e2&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> <span style=color:#f92672>}</span>,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> <span style=color:#e6db74>&#34;layers&#34;</span>: <span style=color:#f92672>[</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   <span style=color:#f92672>{</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>     <span style=color:#e6db74>&#34;mediaType&#34;</span>: <span style=color:#e6db74>&#34;application/vnd.docker.image.rootfs.diff.tar.gzip&#34;</span>,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>     <span style=color:#e6db74>&#34;size&#34;</span>: 5865472,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>     <span style=color:#e6db74>&#34;digest&#34;</span>: <span style=color:#e6db74>&#34;sha256:e2eb06d8af8218cfec8210147357a68b7e13f7c485b991c288c2d01dc228bb68&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>   <span style=color:#f92672>}</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span> <span style=color:#f92672>]</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#f92672>}</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>Both layers should be found under <em>https://host/v2/elek/herbsttag/blobs.</em> The layer in the manifest is a simple tar.gz file with the file system containing the first one, which is another JSON descriptor that includes all the container settings (labels), endpoints, environment variables, default volumes, etc.</p><p>If we upload the layers and metadata files in the same structure, Docker pull will be able to download our Docker images directly from the Storj decentralized cloud. But there are some catches:</p><p><img src=/dcs/_assets/1-fix.png alt></p><ol><li>The <em>/v2</em> endpoint should return with 200 (Docker uses this to double-check if registry implements v2 container registry). We will solve this by uploading an empty HTML file to <em>/v2/index.html.</em></li><li>A specific <em>Content-Type</em> should be returned for each manifest. Fortunately, Storj linksharing service supports custom content-type. We will solve this with uploading the manifest file with custom metadata:<br><em>uplink cp /tmp/1 sj://dockerrepo/v2/elek/herbsttag/latest &ndash;metadata &lsquo;{&ldquo;Content-Type&rdquo;:&ldquo;application/vnd.docker.distribution.manifest.v2+json&rdquo;}&rsquo;</em></li><li>The container registry should be served under the root path of the domain (<em>https://host/v2</em> is correct, while <em>https://host/some/dir/deeper/v2</em> is incorrect). It can be resolved by assigning a custom domain name for the Storj bucket.</li></ol><h3 id=publish-the-container-a-href_8ar1a9qed06y-id_8ar1a9qed06ya>Publish the container <a href=#_8ar1a9qed06y id=_8ar1a9qed06y></a>
<a class=anchor href=#publish-the-container-a-href_8ar1a9qed06y-id_8ar1a9qed06ya>#</a></h3><p>So let’s see an example. What is the publishing process, assuming we have a local docker container (elek/herbsttag in this example)?</p><p>The process is simple:</p><ol><li>Create/prepare all the JSON / blob files to upload to Storj DCS with uplink CLI (or UI)</li><li>During the upload, define the custom HTTP header for the manifests</li><li>Upload blobs</li><li>Upload an empty index.html to make the `/v2` endpoint work</li><li>Define custom domain name for your registry.</li></ol><p>The first step can be done with
<a href=https://github.com/containers/skopeo>skopeo</a>, which is a command-line utility to copy container images between different types of registries (including local Docker daemon, and directories):</p><p><em>skopeo copy docker-daemon:elek/herbsttag:latest dir:/tmp/container</em></p><p><img src=/dcs/_assets/2-fix.png alt></p><p>The result is very close to what we really need:</p><ul><li>manifests.json should be uploaded to /v2/elek/herbsttag/manifests/latest</li><li>The two hash-named layers are blobs to /v2/elek/herbsttag/blobs/</li><li>version file is not required</li></ul><p>Let’s upload them with uplink cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#just to make /v2 work</span>
</span></span><span style=display:flex><span>touch index.html
</span></span><span style=display:flex><span>uplink cp index.html sj://registry/v2/index.html
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#upload manifest with custom content type</span>
</span></span><span style=display:flex><span>uplink cp manifest.json sj://registry/v2/elek/herbsttag/manifests/latest --metadata <span style=color:#e6db74>&#39;{&#34;Content-Type&#34;:&#34;application/vnd.docker.distribution.manifest.v2+json&#34;}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#note: sha256: prefix is added to the filenames</span>
</span></span><span style=display:flex><span>uplink cp 833c7a986ed965eec8fe864223920c366fb0a25dd23edd0bdd2a4428fd0ce1e2 sj://registry/v2/elek/herbsttag/blobs/sha256:833c7a986ed965eec8fe864223920c366fb0a25dd23edd0bdd2a4428fd0ce1e2
</span></span><span style=display:flex><span>uplink cp e2eb06d8af8218cfec8210147357a68b7e13f7c485b991c288c2d01dc228bb68 sj://registry/v2/elek/herbsttag/blobs/sha256:e2eb06d8af8218cfec8210147357a68b7e13f7c485b991c288c2d01dc228bb68
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#it&#39;s a good idea to support sha256 based pulls</span>
</span></span><span style=display:flex><span>sha256sum manifest.json
</span></span><span style=display:flex><span><span style=color:#75715e>#output: be9eeb0e64046a25df3df2df0eb2577ea11a9e521733b6e10df37914cddc7bcb  manifest.json</span>
</span></span><span style=display:flex><span>uplink cp manifest.json sj://registry/v2/elek/herbsttag/manifests/sha256sum:be9eeb0e64046a25df3df2df0eb2577ea11a9e521733b6e10df37914cddc7bcb --metadata <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;Content-Type&#34;</span>:<span style=color:#e6db74>&#34;application/vnd.docker.distribution.manifest.v2+json&#34;</span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Now we are almost there. There are two remaining parts. First, we need to register a custom domain for our <em>sj://registry</em> bucket. The exact process is documented
<a href=https://storj-labs.gitbook.io/dcs/how-tos/host-a-static-website/host-a-static-website-with-the-cli-and-linksharing-service>here</a>, in short, an uplink command can be used to save the access grant and assign it to a domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uplink share --public sj://registry/ --base-url https://link.eu1.storjshare.io --dns registry.anzix.net --auth-service https://auth.eu1.storjshare.io
</span></span></code></pre></div><p>The command returns all the important information to modify the DNS zones. The usage of this information depends on the DNS registrar.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># DNS INFO </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Remember to update the $ORIGIN with your domain name. You may also change the $TTL.</span>
</span></span><span style=display:flex><span>$ORIGIN example.com.
</span></span><span style=display:flex><span>$TTL    <span style=color:#ae81ff>3600</span>
</span></span><span style=display:flex><span>registry.anzix.net     IN CNAME  link.eu1.storjshare.io.
</span></span><span style=display:flex><span>txt-registry.anzix.net IN TXT    storj-root:docker
</span></span><span style=display:flex><span>txt-registry.anzix.net IN TXT    storj-access:jvydrxvotvks3tulle6pkvzmsgza
</span></span></code></pre></div><p>The last piece is the configuration of your local docker daemon. The Storj linksharing service doesn’t support custom SSL certificates (yet), therefore Docker should use HTTP to access it (another workaround here is terminating the SSL with a CDN service like Cloudflare).</p><p>Modify <code>/etc/docker/daemon/json</code> and add the following section:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span> <span style=color:#f92672>&#34;insecure-registries&#34;</span> : [<span style=color:#e6db74>&#34;registry.anzix.net&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And now we can test the pull command:</p><p><img src=/dcs/_assets/3-fix.png alt></p><h3 id=summary-a-href_hzafm3yc7150-id_hzafm3yc7150a>Summary <a href=#_hzafm3yc7150 id=_hzafm3yc7150></a>
<a class=anchor href=#summary-a-href_hzafm3yc7150-id_hzafm3yc7150a>#</a></h3><p>Storj supports custom Content-Type for any key, so it can be used as a container registry to distribute container images. Currently, it has some limitations (no custom SSL, push is a manual process, no easy way to share layers), but distributing static container images for a large-scale audience can be done with all the advantages of a real Decentralized Cloud Storage.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><div class=toc-title>Contents</div><nav id=TableOfContents><ul><li><ul><li><a href=#the-structure-of-a-container-registry-a-href_394oki6cys24-id_394oki6cys24a>The structure of a container registry <a href=#_394oki6cys24 id=_394oki6cys24></a></a></li><li><a href=#publish-the-container-a-href_8ar1a9qed06y-id_8ar1a9qed06ya>Publish the container <a href=#_8ar1a9qed06y id=_8ar1a9qed06y></a></a></li><li><a href=#summary-a-href_hzafm3yc7150-id_hzafm3yc7150a>Summary <a href=#_hzafm3yc7150 id=_hzafm3yc7150></a></a></li></ul></li></ul></nav></div></aside></main></body></html>